{"version":3,"file":"js/7975.a86d5705.js","mappings":"8KAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,sCAAsC,CAACF,EAAG,YAAY,CAACG,IAAI,SAASD,YAAY,8BAA8BE,MAAM,CAAE,eAA8B,WAAdR,EAAIS,OAAqBC,MAAM,CAAC,OAAS,IAAI,kBAAiB,EAAM,aAAaV,EAAIW,oBAAoB,gBAAgBX,EAAIY,mBAAmB,eAAeZ,EAAIa,aAAa,UAAW,IAAQ,CAAEb,EAAY,SAAEI,EAAG,YAAY,CAACE,YAAY,SAASQ,MAAM,CAAGC,MAAO,OAAQC,OAAQ,QAAUN,MAAM,CAAC,IAAMV,EAAIiB,SAAS,IAAM,UAAUb,EAAG,YAAY,CAACU,MAAM,CAAGC,MAAO,OAAQC,OAAQ,QAAUN,MAAM,CAAC,IAAMV,EAAIkB,eAAe,GAAGd,EAAG,IAAI,CAACE,YAAY,kBAAkB,CAACN,EAAImB,GAAGnB,EAAIoB,GAAGpB,EAAIqB,UAAUjB,EAAG,QAAQ,CAACE,YAAY,mBAAmBI,MAAM,CAAC,KAAO,OAAO,KAAO,QAAQY,GAAG,CAAC,OAAStB,EAAIuB,eAAe,EAAE,EACr1BC,EAAkB,GCqCtB,GACEC,MAAO,CAELC,IAAK,CACHC,KAAMC,OACNC,QAAS,IAGXR,MAAO,CACLM,KAAMC,OACNC,QAAS,UAGXX,WAAY,CACVS,KAAMC,OACNC,QAASA,EAAQA,QAGnBpB,MAAO,CACLkB,KAAMC,OACNC,QAAS,KAIbC,MAAO,CACLJ,IAAIK,GACa,KAAXA,IACF9B,KAAKgB,SAAWc,EAEpB,GAGFC,OACE,MAAO,CAELC,SAAU,GACVhB,SAAU,GAEd,EAEAiB,UACmB,KAAbjC,KAAKyB,MACPzB,KAAKgB,SAAWhB,KAAKyB,IAEzB,EAEAS,QAAS,CACPC,iBAAiBC,SACTpC,KAAKW,mBAAmByB,EAAEC,OAAOC,MAAM,IACzCtC,KAAKuC,MACPvC,KAAKY,cAET,EAIAF,oBAAoB8B,EAAUD,EAAMP,GAClCS,QAAQC,IACd,sCACAF,EACAD,EACAP,EAEI,EAIArB,mBAAmB4B,GACjBE,QAAQC,IAAI,oCAAqCH,GACjDvC,KAAKuC,KAAOA,CACd,EAIAJ,qBACE,MAAMJ,EAAO,CACXQ,KAAMvC,KAAKuC,MAEPI,QAAY3C,KAAK4C,SAAS,kBAAmBb,GACnDU,QAAQC,IAAI,qBAAsBC,GAClC3C,KAAKgB,SAAW2B,EAChB3C,KAAK6C,QACP,EAKAA,SACE7C,KAAK8C,MAAM,SAAU9C,KAAKgB,SAC5B,IC/HwR,I,WCQxR+B,GAAY,OACd,EACAjD,EACAyB,GACA,EACA,KACA,WACA,MAIF,EAAewB,EAAiB,O","sources":["webpack://home_research_h5/./src/components/AvatarUpload/index.vue?4f59","webpack://home_research_h5/src/components/AvatarUpload/index.vue","webpack://home_research_h5/./src/components/AvatarUpload/index.vue?a19b","webpack://home_research_h5/./src/components/AvatarUpload/index.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"avatar-upload-container flex-start\"},[_c('el-upload',{ref:\"upload\",staticClass:\"avatar-uploader flex-center\",class:{ 'square-style': _vm.shape === 'square' },attrs:{\"action\":\"#\",\"show-file-list\":false,\"on-success\":_vm.handleAvatarSuccess,\"before-upload\":_vm.beforeAvatarUpload,\"http-request\":_vm.submitUpload,\"multiple\":false}},[(_vm.imageUrl)?_c('van-image',{staticClass:\"avatar\",style:({ width: '100%', height: '100%' }),attrs:{\"src\":_vm.imageUrl,\"fit\":\"fill\"}}):_c('van-image',{style:({ width: '100%', height: '100%' }),attrs:{\"src\":_vm.defaultSrc}})],1),_c('p',{staticClass:\"describe-style\"},[_vm._v(_vm._s(_vm.title))]),_c('input',{staticClass:\"file-input-style\",attrs:{\"type\":\"file\",\"name\":\"file\"},on:{\"change\":_vm.changeFile}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"avatar-upload-container flex-start\">\r\n    <el-upload\r\n      class=\"avatar-uploader flex-center\"\r\n      :class=\"{ 'square-style': shape === 'square' }\"\r\n      action=\"#\"\r\n      :show-file-list=\"false\"\r\n      :on-success=\"handleAvatarSuccess\"\r\n      :before-upload=\"beforeAvatarUpload\"\r\n      :http-request=\"submitUpload\"\r\n      :multiple=\"false\"\r\n      ref=\"upload\"\r\n    >\r\n      <van-image\r\n        v-if=\"imageUrl\"\r\n        :style=\"{ width: '100%', height: '100%' }\"\r\n        :src=\"imageUrl\"\r\n        fit=\"fill\"\r\n        class=\"avatar\"\r\n      />\r\n      <van-image\r\n        v-else\r\n        :style=\"{ width: '100%', height: '100%' }\"\r\n        :src=\"defaultSrc\"\r\n      ></van-image>\r\n    </el-upload>\r\n\r\n    <p class=\"describe-style\">{{ title }}</p>\r\n    <input\r\n      type=\"file\"\r\n      name=\"file\"\r\n      class=\"file-input-style\"\r\n      @change=\"changeFile\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    // 头像地址\r\n    src: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    // 标题\r\n    title: {\r\n      type: String,\r\n      default: \"点击上传头像\",\r\n    },\r\n    // 默认图地址\r\n    defaultSrc: {\r\n      type: String,\r\n      default: require(\"@/assets/images/avatar_default.png\"),\r\n    },\r\n    // 形状 默认为空, 方形为square\r\n    shape: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n  },\r\n\r\n  watch: {\r\n    src(newVal) {\r\n      if (newVal !== \"\") {\r\n        this.imageUrl = newVal;\r\n      }\r\n    },\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      // 已上传的文件列表\r\n      fileList: [],\r\n      imageUrl: \"\",\r\n    };\r\n  },\r\n\r\n  created() {\r\n    if (this.src !== \"\") {\r\n      this.imageUrl = this.src;\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    async changeFile(e) {\r\n      await this.beforeAvatarUpload(e.target.files[0]);\r\n      if (this.file) {\r\n        this.submitUpload();\r\n      }\r\n    },\r\n    /**\r\n     * 文件上传成功时的钩子\r\n     */\r\n    handleAvatarSuccess(response, file, fileList) {\r\n      console.log(\r\n        \"文件上传成功时的钩子_handleAvatarSuccess :>> \",\r\n        response,\r\n        file,\r\n        fileList\r\n      );\r\n    },\r\n    /**\r\n     * 上传文件之前的钩子，参数为上传的文件，若返回 false 或者返回 Promise 且被 reject，则停止上传。\r\n     */\r\n    beforeAvatarUpload(file) {\r\n      console.log(\"上传文件之前的钩子_beforeAvatarUpload :>> \", file);\r\n      this.file = file;\r\n    },\r\n    /**\r\n     * 覆盖默认的上传行为，可以自定义上传的实现\r\n     */\r\n    async submitUpload() {\r\n      const data = {\r\n        file: this.file,\r\n      };\r\n      const res = await this.$request(\"aoss.fileUpload\", data);\r\n      console.log(\"覆盖默认的上传行为_res :>> \", res);\r\n      this.imageUrl = res;\r\n      this.change();\r\n    },\r\n    /**\r\n     * 更改图片地址\r\n     * @returns {String} 新的图片地址\r\n     */\r\n    change() {\r\n      this.$emit(\"change\", this.imageUrl);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.avatar-upload-container {\r\n  position: relative;\r\n  .uploader-style {\r\n    ::v-deep {\r\n      .van-uploader__preview {\r\n        .van-uploader__preview-image {\r\n          .van-image__img {\r\n            width: 100%;\r\n            height: 100%;\r\n          }\r\n        }\r\n      }\r\n      .van-uploader__upload {\r\n        width: 160px;\r\n        height: 215px;\r\n        .van-icon__image {\r\n          width: 100%;\r\n          height: 100%;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .avatar-uploader {\r\n    width: px(160);\r\n    height: px(215);\r\n    border-radius: px(16);\r\n    overflow: hidden;\r\n    ::v-deep {\r\n      .el-upload {\r\n        width: 100%;\r\n        height: 100%;\r\n      }\r\n    }\r\n  }\r\n\r\n  .square-style {\r\n    width: px(160);\r\n    height: px(160);\r\n  }\r\n\r\n  .describe-style {\r\n    margin-left: px(28);\r\n    font-size: px(32);\r\n    font-weight: bold;\r\n  }\r\n\r\n  .file-input-style {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n    opacity: 0;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=63a9d4e7&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=63a9d4e7&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"63a9d4e7\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","class","shape","attrs","handleAvatarSuccess","beforeAvatarUpload","submitUpload","style","width","height","imageUrl","defaultSrc","_v","_s","title","on","changeFile","staticRenderFns","props","src","type","String","default","watch","newVal","data","fileList","created","methods","async","e","target","files","file","response","console","log","res","$request","change","$emit","component"],"sourceRoot":""}